/home/ubuntu/miniconda3/lib/python3.10/site-packages/transformers/optimization.py:407: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
  0%|                                                                                                                     | 0/2097 [00:00<?, ?it/s]/home/ubuntu/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '











































































































 24%|█████████████████████████▋                                                                                 | 503/2097 [03:36<11:18,  2.35it/s]










































 33%|███████████████████████████████████▋                                                                       | 699/2097 [05:00<08:42,  2.68it/s]
















  probs = softmax(torch.Tensor(predictions))█████████████████████████████████████████████████████████████████████| 175/175 [00:35<00:00,  5.53it/s]
/home/ubuntu/miniconda3/lib/python3.10/site-packages/sklearn/preprocessing/_encoders.py:868: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.
  warnings.warn(
 33%|███████████████████████████████████▋                                                                       | 699/2097 [05:36<08:42,  2.68it/s]
 33%|███████████████████████████████████▋                                                                       | 699/2097 [05:36<08:42,  2.68it/s]/home/ubuntu/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
































































 48%|██████████████████████████████████████████████████▌                                                       | 1001/2097 [07:52<07:47,  2.34it/s]




















































































 67%|██████████████████████████████████████████████████████████████████████▋                                   | 1398/2097 [10:42<04:09,  2.80it/s]
















  probs = softmax(torch.Tensor(predictions))█████████████████████████████████████████████████████████████████████| 175/175 [00:34<00:00,  5.77it/s]
/home/ubuntu/miniconda3/lib/python3.10/site-packages/sklearn/preprocessing/_encoders.py:868: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.
  warnings.warn(
{'eval_loss': 0.05637490004301071, 'eval_f1': 0.8641450313339301, 'eval_roc_auc': 0.9272205525003198, 'eval_accuracy': 0.8641450313339302, 'eval_runtime': 34.7163, 'eval_samples_per_second': 1287.004, 'eval_steps_per_second': 5.041, 'epoch': 2.0}
 67%|██████████████████████████████████████████████████████████████████████▋                                   | 1398/2097 [11:17<04:09,  2.80it/s]/home/ubuntu/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '





















 71%|███████████████████████████████████████████████████████████████████████████▋                              | 1497/2097 [12:07<04:16,  2.34it/s]











































































































 95%|████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 1996/2097 [15:41<00:43,  2.32it/s]





















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 2097/2097 [16:25<00:00,  2.78it/s]
















  probs = softmax(torch.Tensor(predictions))█████████████████████████████████████████████████████████████████████| 175/175 [00:34<00:00,  5.81it/s]
/home/ubuntu/miniconda3/lib/python3.10/site-packages/sklearn/preprocessing/_encoders.py:868: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.
  warnings.warn(
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 2097/2097 [17:00<00:00,  2.78it/s]
{'eval_loss': 0.051329873502254486, 'eval_f1': 0.8760966875559535, 'eval_roc_auc': 0.9336232254764036, 'eval_accuracy': 0.8760966875559535, 'eval_runtime': 34.658, 'eval_samples_per_second': 1289.17, 'eval_steps_per_second': 5.049, 'epoch': 3.0}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 2097/2097 [17:06<00:00,  2.04it/s]
/home/ubuntu/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '































































































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 976/976 [03:11<00:00,  6.00it/s]/efs/Users/Hang/LLM_FT_3GPP/LLM_FT_3GPP.py:112: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  probs = softmax(torch.Tensor(predictions))
/home/ubuntu/miniconda3/lib/python3.10/site-packages/sklearn/preprocessing/_encoders.py:868: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.
  warnings.warn(
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 976/976 [03:13<00:00,  5.04it/s]
Performance of BERT before fine-tuning on 3GPP files:
{'eval_loss': 0.7244918346405029, 'eval_f1': 0.015930734543823537, 'eval_roc_auc': 0.4728200363627626, 'eval_accuracy': 0.015930734543823537, 'eval_runtime': 205.8419, 'eval_samples_per_second': 1213.096, 'eval_steps_per_second': 4.742}
Performance of BERT after fine-tuning on 3GPP files:
{'eval_loss': 0.06829479336738586, 'eval_f1': 0.8217383643164361, 'eval_roc_auc': 0.9045026951695193, 'eval_accuracy': 0.8217383643164361, 'eval_runtime': 193.6813, 'eval_samples_per_second': 1289.262, 'eval_steps_per_second': 5.039, 'epoch': 3.0}